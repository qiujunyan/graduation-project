#include "stdafx.h"
#include "opencv2/opencv.hpp"
#include "iostream"
#include <fstream>  
#include "time.h"
#include "math.h"

using namespace cv;
using namespace std;

void main()
{
	IplImage *src = cvLoadImage("E:\\c20.jpg",CV_8UC1);
	int pixel = 0;
	int count[256];
	for (int i = 0; i < 256; i++)
		count[i] = 0;

	for (int i = 0; i < src->height; i++)
		for (int j = 0; j < src->width; j++)
		{
			pixel = ((uchar*)(src->imageData+src->widthStep*i))[j];
			count[pixel]++;
		}

	int total=0;
	for (int i = 0; i < 256; i++)
	{
		total += count[i];
		cout << count[i]<<endl;
		if (total >= 3000)
		{
			cout << "pixel:"<<i<<endl;
			break;
		}
	}

	int a = 0;
	cvThreshold(src, src, 0, 255, CV_THRESH_OTSU);
	for (int i = 0; i < src->height; i++)
		for (int j = 0; j < src->width; j++)
		{
			if (((uchar*)(src->imageData + src->widthStep*i))[j] == 0)
				a++;
		}
	
	cvShowImage("src", src);
	cout << a << endl;//a为分界点
	cvWaitKey();
}
